---
layout: '@/layouts/DocumentationLayout.astro'
title: GraphQLAPI
---

This class makes handling GraphQL APIs easier by abstracting some essential features.

- Base URL
- Base Fetch Configuration
- Status

### Base URL

```ts
import { GraphQLAPI, gql } from '@aracna/core'

const DummyAPI: GraphQLAPI = new GraphQLAPI(
  'https://graphqlzero.almansi.me/api'
)

const GET_USERS_QUERY: string = gql`
  query getUsers {
    users {
      data {
        id
      }
    }
  }
`

// will automatically run this query against "https://graphqlzero.almansi.me/api"
DummyAPI.handle(GET_USERS_QUERY)
```

### Base Fetch Configuration

```ts
import { GraphQLAPI, gql } from '@aracna/core'

const DummyAPI: GraphQLAPI = new GraphQLAPI(
  'https://graphqlzero.almansi.me/api',
  { headers: { authorization: 'Bearer $token' } }
)

const GET_USERS_QUERY: string = gql`
  query getUsers {
    users {
      data {
        id
      }
    }
  }
`

// will automatically run this query with the authorization header
DummyAPI.handle(GET_USERS_QUERY)
```

### Status

```ts
import {
  FetchError,
  FetchResponse,
  GraphQLAPI,
  gql,
  RequestMethod
} from '@aracna/core'

const DummyAPI: GraphQLAPI = new GraphQLAPI(
  'https://graphqlzero.almansi.me/api'
)

const GET_USERS_QUERY: string = gql`
  query getUsers {
    users {
      data {
        id
      }
    }
  }
`

DummyAPI.get(GET_USERS_QUERY)
  .then((response: FetchResponse) => {
    // will log true
    console.log(DummyAPI.status.isSuccess(RequestMethod.POST, GET_USERS_QUERY))
  })
  .catch((error: FetchError) => {
    // will log true
    console.log(DummyAPI.status.isError(RequestMethod.POST, GET_USERS_QUERY))
  })

// will log true
console.log(DummyAPI.status.isPending(RequestMethod.POST, GET_USERS_QUERY))
```

### Advanced Features

- Custom Configuration
- Status Handlers

### Custom Configuration

```ts
import { FetchResponse, GraphQLAPI, GraphQLAPIConfig, gql } from '@aracna/core'

interface DummyAPIConfig extends GraphQLAPIConfig {
  useAuthorization?: boolean
}

const DummyAPI: GraphQLAPI<DummyAPIConfig> = new GraphQLAPI(
  'https://graphqlzero.almansi.me/api'
)

DummyAPI.handlePending = async <V>(
  query: string,
  variables: V | undefined,
  config: T
): Promise<boolean> => {
  if (config.useAuthorization) {
    config.headers = { authorization: 'Bearer $token' }
  }

  return true
}

const GET_USERS_QUERY: string = gql`
  query getUsers {
    users {
      data {
        id
      }
    }
  }
`

// will automatically perform this request with the authorization header
DummyAPI.get(GET_USERS_QUERY, { useAuthorization: true })
```

### Status Handlers

```ts
import { FetchResponse, GraphQLAPI, gql } from '@aracna/core'

const DummyAPI: GraphQLAPI = new GraphQLAPI(
  'https://graphqlzero.almansi.me/api'
)

DummyAPI.handleError = async <V, W = U>(
  query: string,
  variables: V | undefined,
  config: T,
  error: FetchError<W>
): Promise<boolean> => {
  window.alert(error.message)

  // if you return true it won't be considered as an error
  return false
}

DummyAPI.handlePending = async <V>(
  query: string,
  variables: V | undefined,
  config: T
): Promise<boolean> => {
  window.alert('PENDING REQUEST FOR QUERY: ' + query)

  // if you return false it will be considered as an error and the request won't be performed
  return true
}

DummyAPI.handleSuccess = async <V, W>(
  query: string,
  variables: W | undefined,
  config: T,
  response: FetchResponse<V>
): Promise<boolean> => {
  window.alert('SUCCESS REQUEST FOR QUERY: ' + query)

  // if you return false it will be considered as an error
  return true
}

const GET_USERS_QUERY: string = gql`
  query getUsers {
    users {
      data {
        id
      }
    }
  }
`

DummyAPI.get(GET_USERS_QUERY)
```
