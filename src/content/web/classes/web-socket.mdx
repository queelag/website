---
title: WebSocket
---

import { CodeBlock } from '@/blocks/CodeBlock'
import { SB_WEB_SOCKET_OPEN, SB_WEB_SOCKET_CLOSE, SB_WEB_SOCKET_SEND, SB_WEB_SOCKET_RECEIVE } from '@/definitions/stack-blitz/web/classes'

The `WebSocket` class is built on top of the native `WebSocket` class.

- The `close` method is asynchronous and resolves when the connection is closed.
- The `open` method is asynchronous and resolves when the connection is opened.
- The `send` method can send blobs, buffers, objects and strings.
- The received message data will be automatically parsed if it is a JSON string.
- The data to send can be transformed before sending with the `transformSendData` method.
- The received data can be transformed before handling it in the message event with the `transformMessageData` method.

## Events

- The `close` event is emitted when the connection is closed.
- The `error` event is emitted when the connection crashes.
- The `message` event is emitted when a message is received.
- The `open` event is emitted when the connection is opened.

## Open the connection

The `open` method opens the connection.
Optionally the binary type, protocols, data transformers and URL can be set before opening the connection.

<CodeBlock
  client:load
  dependencies={{ '@aracna/core': 'latest', '@aracna/web': 'latest' }}
  files={SB_WEB_SOCKET_OPEN}
  template='javascript'
  title='WebSocket'
  console={100}
/>

## Close the connection

The `close` method closes the connection. Optionally with a code and a reason.

<CodeBlock
  client:load
  dependencies={{ '@aracna/core': 'latest', '@aracna/web': 'latest' }}
  files={SB_WEB_SOCKET_CLOSE}
  template='javascript'
  title='WebSocket'
  console={100}
/>

## Send data

The `send` method sends data to the web socket.

- The data will be left as is if it is an `ArrayBuffer` or a `Blob`.
- The data will be JSON stringified if it is an object.
- The data will be transformed with the `transformSendData` method.

<CodeBlock
  client:load
  dependencies={{ '@aracna/core': 'latest', '@aracna/web': 'latest' }}
  files={SB_WEB_SOCKET_SEND}
  template='javascript'
  title='WebSocket'
  console={100}
/>

## Listen to messages

The `message` event is emitted when a message is received. The class is an `EventEmitter` so the `on` method can be used to listen to the event.

<CodeBlock
  client:load
  dependencies={{ '@aracna/core': 'latest', '@aracna/web': 'latest' }}
  files={SB_WEB_SOCKET_RECEIVE}
  template='javascript'
  title='WebSocket'
  console={100}
/>
